<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.heeexy.example.dao.ThumbsUpDao">

    <!--获取用户的点赞用户ID-->
    <select id="getLikeList" resultType="com.alibaba.fastjson.JSONObject">

        select user_id userId
        from click_goods
        where
        post_id = #{postId}
    </select>
    <!--<select id=""-->

    <!--统计点赞数量-->
    <select id="countLikes" resultType="java.lang.Integer">
        SELECT
        count(0)
        FROM click_goods
        where post_id = #{postId}
    </select>
    <!--新增点赞-->
    <insert id="addLike" parameterType="com.alibaba.fastjson.JSONObject" >

        <selectKey keyProperty="id" resultType="String" order="BEFORE">
            select  replace(uuid(),'-','')   from dual
        </selectKey>

        insert into click_goods (like_id, post_id,user_id)
        values (#{id,jdbcType=VARCHAR}, #{postId},#{uuId})
    </insert>

    <!--取消点赞-->
    <delete id="removeLike" parameterType="com.alibaba.fastjson.JSONObject">
        delete from click_goods

        WHERE user_id = #{uuId} AND post_id = #{postId}

    </delete>

    <!--判断是否之前是否点赞-->
    <select id="queryExist" resultType="java.lang.Integer">
        SELECT count(0)
        FROM click_goods
        WHERE user_id = #{uuId} AND post_id = #{postId}
    </select>




</mapper>